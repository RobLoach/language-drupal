'.text.drupal':
  'hook_field_formatter_prepare_view':
    'prefix': 'hook_field_formatter_prepare_view'
    'body': '/**\n * Implements hook_field_formatter_prepare_view().\n */\nfunction $1_field_formatter_prepare_view(\$entity_type, \$entities, \$field, \$instances, \$langcode, &\$items, \$displays) {\n  /*\n   *  \$tids = array();\n   *\n   *  // Collect every possible term attached to any of the fieldable entities.\n   *  foreach (\$entities as \$id => \$entity) {\n   *    foreach (\$items[\$id] as \$delta => \$item) {\n   *      // Force the array key to prevent duplicates.\n   *      \$tids[\$item[\'tid\']] = \$item[\'tid\'];\n   *    }\n   *  }\n   *\n   *  if (\$tids) {\n   *    \$terms = taxonomy_term_load_multiple(\$tids);\n   *\n   *    // Iterate through the fieldable entities again to attach the loaded term\n   *    // data.\n   *    foreach (\$entities as \$id => \$entity) {\n   *      \$rekey = FALSE;\n   *\n   *      foreach (\$items[\$id] as \$delta => \$item) {\n   *        // Check whether the taxonomy term field instance value could be loaded.\n   *        if (isset(\$terms[\$item[\'tid\']])) {\n   *          // Replace the instance value with the term data.\n   *          \$items[\$id][\$delta][\'taxonomy_term\'] = \$terms[\$item[\'tid\']];\n   *        }\n   *        // Otherwise, unset the instance value, since the term does not exist.\n   *        else {\n   *          unset(\$items[\$id][\$delta]);\n   *          \$rekey = TRUE;\n   *        }\n   *      }\n   *\n   *      if (\$rekey) {\n   *        // Rekey the items array.\n   *        \$items[\$id] = array_values(\$items[\$id]);\n   *      }\n   *    }\n   *  }\n   */\n  ${1:/* Your code here */}\n}'